<!DOCTYPE html>
<html>
<head>
    <title>Rojgar Result Admin - Sarkari Job Portal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Arial', sans-serif; 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
        }
        
        /* Header - Rojgar Result Style */
        .header {
            background: #dc3545; 
            color: white; 
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        .header-content {
            max-width: 1200px; 
            margin: 0 auto; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 0 2rem;
        }
        .logo { font-size: 1.8rem; font-weight: bold; }
        .header-nav a { 
            color: white; 
            text-decoration: none; 
            margin-left: 2rem; 
            font-weight: 500;
        }
        
        /* Main Container */
        .container { 
            max-width: 1200px; 
            margin: 2rem auto; 
            padding: 0 1rem;
        }
        
        /* Stats Cards - Rojgar Style */
        .stats-row {
            display: grid; 
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); 
            gap: 1.5rem; 
            margin-bottom: 2rem;
        }
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 5px solid #dc3545;
        }
        .stat-number { 
            font-size: 2.5rem; 
            font-weight: bold; 
            color: #dc3545; 
            margin-bottom: 0.5rem;
        }
        
        /* Tabs - Rojgar Result Red Theme */
        .tabs {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        .tab-btn {
            padding: 1rem 1.5rem;
            border: none;
            background: #f8f9fa;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        .tab-btn.active {
            background: #dc3545;
            color: white;
            box-shadow: 0 5px 15px rgba(220,53,69,0.4);
        }
        
        /* Content Areas */
        .tab-content {
            display: none;
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            animation: fadeIn 0.3s;
        }
        .tab-content.active { display: block; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Form Styling */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        label { 
            font-weight: 600; 
            margin-bottom: 0.5rem; 
            color: #333;
        }
        input, select, textarea {
            padding: 1rem;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #dc3545;
            box-shadow: 0 0 0 3px rgba(220,53,69,0.1);
        }
        textarea { min-height: 100px; resize: vertical; }
        
        /* Buttons */
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        .btn-primary { 
            background: #dc3545; 
            color: white; 
        }
        .btn-primary:hover { 
            background: #c82333; 
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220,53,69,0.4);
        }
        .btn-success { 
            background: #28a745; 
            color: white; 
        }
        .btn-danger { 
            background: #dc3545; 
            color: white; 
        }
        
        /* Jobs Table */
        .table-responsive { overflow-x: auto; }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        th {
            background: #dc3545;
            color: white;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            position: sticky;
            top: 0;
        }
        td { 
            padding: 1rem; 
            border-bottom: 1px solid #e9ecef; 
        }
        tr:hover { background: #f8f9fa; }
        
        /* Status Badges */
        .badge {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .badge-active { background: #d4edda; color: #155724; }
        .badge-expired { background: #f8d7da; color: #721c24; }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 1rem; }
            .form-grid { grid-template-columns: 1fr; }
            .tabs { justify-content: center; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-content">
            <div class="logo">üî¥ ROJGAR RESULT ADMIN</div>
            <nav>
                <a href="/" class="btn btn-primary">üëÅÔ∏è View Portal</a>
                <a href="/admin-logout" class="btn btn-danger">üö™ Logout</a>
            </nav>
        </div>
    </div>

    <div class="container">
        <!-- Stats Cards -->
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-number"><%= jobs.length %></div>
                <h3>Total Jobs</h3>
            </div>
            <div class="stat-card">
                <div class="stat-number"><%= jobs.filter(j => new Date(j.lastDate) >= new Date()).length %></div>
                <h3>Active Jobs</h3>
            </div>
            <div class="stat-card">
                <div class="stat-number"><%= jobs.filter(j => new Date(j.lastDate) < new Date()).length %></div>
                <h3>Expired Jobs</h3>
            </div>
            <div class="stat-card">
                <div class="stat-number">‚Çπ0</div>
                <h3>Revenue</h3>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('add')">‚ûï Add Job</button>
            <button class="tab-btn" onclick="showTab('manage')">üìã Manage Jobs</button>
            <button class="tab-btn" onclick="showTab('categories')">üè∑Ô∏è Categories</button>
            <button class="tab-btn" onclick="showTab('stats')">üìä Statistics</button>
            <button class="tab-btn" onclick="showTab('settings')">‚öôÔ∏è Settings</button>
        </div>

        <!-- Add Job Tab -->
        <div id="add" class="tab-content active">
            <h2>‚ûï Add New Sarkari Job (Rojgar Result Style)</h2>
            <form id="addJobForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label>üìå Job Title *</label>
                        <input name="title" placeholder="SSC CGL 2026 - 10,000+ Posts" required>
                    </div>
                    <div class="form-group">
                        <label>üè∑Ô∏è Category *</label>
                        <select name="category" required>
                            <option value="">Select Category</option>
                            <option value="SSC">SSC</option>
                            <option value="UPSC">UPSC</option>
                            <option value="Railway">Railway</option>
                            <option value="Banking">Banking</option>
                            <option value="Police">Police</option>
                            <option value="Teaching">Teaching</option>
                            <option value="Defence">Defence</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>üîó Apply Link *</label>
                        <input name="link" placeholder="https://ssc.nic.in/cgl2026" required>
                    </div>
                    <div class="form-group">
                        <label>üìÖ Last Date *</label>
                        <input name="lastDate" type="date" required>
                    </div>
                    <div class="form-group" style="grid-column: span 2;">
                        <label>üìù Description</label>
                        <textarea name="description" placeholder="Full job details..."></textarea>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary" style="font-size: 1.1rem;">
                    üöÄ Publish Job Now
                </button>
            </form>
        </div>

        <!-- Manage Jobs Tab -->
        <div id="manage" class="tab-content">
            <div style="display: flex; gap: 1rem; margin-bottom: 1rem; flex-wrap: wrap;">
                <input id="searchJobs" placeholder="üîç Search jobs by title..." style="flex: 1; min-width: 250px;">
                <select id="filterCategory" style="padding: 1rem;">
                    <option value="">All Categories</option>
                    <option value="SSC">SSC</option>
                    <option value="UPSC">UPSC</option>
                    <option value="Railway">Railway</option>
                </select>
                <button class="btn btn-danger" onclick="deleteSelectedJobs()">üóëÔ∏è Delete Selected</button>
            </div>
            
            <div class="table-responsive">
                <table>
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="selectAll"></th>
                            <th>Job Title</th>
                            <th>Category</th>
                            <th>Posts</th>
                            <th>Last Date</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="jobsTableBody">
                        <% jobs.forEach((job, index) => { %>
                        <tr>
                            <td><input type="checkbox" class="job-select" value="<%= job._id || index %>"></td>
                            <td style="font-weight: 500;"><%= job.title %></td>
                            <td><span class="badge"><%= job.category %></span></td>
                            <td>-</td>
                            <td><%= new Date(job.lastDate).toLocaleDateString('en-IN') %></td>
                            <td>
                                <span class="badge <%= new Date(job.lastDate) >= new Date() ? 'badge-active' : 'badge-expired' %>">
                                    <%= new Date(job.lastDate) >= new Date() ? '‚úÖ Active' : '‚ùå Expired' %>
                                </span>
                            </td>
                            <td>
                                <button onclick="editJob(<%= JSON.stringify(job).replace(/"/g, '&quot;') %>, '<%= job._id || index %>')" 
                                        class="btn btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem;">‚úèÔ∏è Edit</button>
                                <button onclick="deleteSingleJob('<%= job._id || index %>')" 
                                        class="btn btn-danger" style="padding: 0.5rem 1rem; font-size: 0.9rem;">üóëÔ∏è Delete</button>
                            </td>
                        </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Other Tabs (Placeholder) -->
        <div id="categories" class="tab-content">
            <h2>üè∑Ô∏è Job Categories Management</h2>
            <p>Coming soon: Add custom categories, set priorities...</p>
        </div>
        <div id="stats" class="tab-content">
            <h2>üìä Statistics Dashboard</h2>
            <p>Job views, clicks, popular categories, revenue...</p>
        </div>
        <div id="settings" class="tab-content">
            <h2>‚öôÔ∏è Portal Settings</h2>
            <p>SEO settings, maintenance mode, backup...</p>
        </div>
    </div>

    <script>
        // Tab Management
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        // Add Job Form
        document.getElementById('addJobForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const jobData = Object.fromEntries(formData);
            jobData._id = Date.now().toString();
            
            try {
                const response = await fetch('/api/jobs', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(jobData)
                });
                
                if (response.ok) {
                    alert('‚úÖ Job published successfully! üéâ');
                    location.reload();
                }
            } catch (error) {
                alert('‚ùå Error publishing job');
            }
        });

        // Search & Filter
        function filterJobs() {
            const search = document.getElementById('searchJobs').value.toLowerCase();
            const category = document.getElementById('filterCategory').value;
            const rows = document.querySelectorAll('#jobsTableBody tr');
            
            rows.forEach(row => {
                const title = row.cells[1].textContent.toLowerCase();
                const cat = row.cells[2].textContent;
                const show = title.includes(search) && (!category || cat.includes(category));
                row.style.display = show ? '' : 'none';
            });
        }

        document.getElementById('searchJobs').addEventListener('input', filterJobs);
        document.getElementById('filterCategory').addEventListener('change', filterJobs);

        // Select All
        document.getElementById('selectAll').addEventListener('change', function() {
            document.querySelectorAll('.job-select').forEach(cb => cb.checked = this.checked);
        });

        // Bulk Delete
        function deleteSelectedJobs() {
            const selected = Array.from(document.querySelectorAll('.job-select:checked')).map(cb => cb.value);
            if (selected.length === 0) return alert('Please select jobs to delete');
            if (confirm(`Delete ${selected.length} jobs?`)) {
                selected.forEach(id => deleteSingleJob(id));
            }
        }

        // Single Delete
        async function deleteSingleJob(id) {
            if (confirm('Delete this job?')) {
                await fetch(`/api/jobs/${id}`, { method: 'DELETE' });
                location.reload();
            }
        }

        // Edit Job
        function editJob(job, id) {
            document.querySelector('[name="title"]').value = job.title || '';
            document.querySelector('[name="category"]').value = job.category || '';
            document.querySelector('[name="link"]').value = job.link || '';
            document.querySelector('[name="lastDate"]').value = job.lastDate ? job.lastDate.split('T')[0] : '';
            document.querySelector('[name="description"]').value = job.description || '';
            showTab('add');
        }
    </script>
</body>
</html>
